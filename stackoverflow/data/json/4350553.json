{
  "type":"StackOverflowArtifact",
  "question":{
    "type":"StackOverflowQuestion",
    "id":4350553,
    "title":"Lock a file and delete it without first releasing the lock",
    "comments":[
      {
        "type":"StackOverflowComment",
        "id":4735484,
        "postId":4350553,
        "creationDate":"2010-12-04",
        "score":0,
        "isEdited":false,
        "owner":{
          "type":"StackOverflowUser",
          "id":207421,
          "displayName":"EJP",
          "reputation":133851
        },
        "source":[
          {
            "type":"SourceInfo",
            "node":{
              "type":"XmlTextNode",
              "contents":"The issue you describe only occurs on Windows. Is that the platform?"
            },
            "units":[
              {
                "type":"TextUnit",
                "id":"[4350553-cu4735484]-[1552958339]",
                "astNode":{
                  "type":"TextFragmentNode",
                  "text":"The issue you describe only occurs on Windows. Is that the platform?"
                },
                "codeFragments":{
                  "type":"CodeFragmentSequence",
                  "fragments":[
                    
                  ]
                },
                "metaInformation":[
                  {
                    "type":"NaturalLanguageMetaInformation",
                    "tfMap":{
                      "window":1,
                      "occur":1,
                      "issu":1,
                      "platform":1,
                      "describ":1
                    }
                  },
                  {
                    "type":"CodeTypesMetaInformation",
                    "qualifiedTypes":[
                      
                    ],
                    "simpleTypes":[
                      
                    ],
                    "basicTypes":[
                      
                    ]
                  },
                  {
                    "type":"CodeInvocationMetaInformation",
                    "invocations":[
                      
                    ]
                  },
                  {
                    "type":"CodeVariablesMetaInformation",
                    "variables":[
                      
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "type":"StackOverflowComment",
        "id":4757538,
        "postId":4350553,
        "creationDate":"2010-12-06",
        "score":0,
        "isEdited":false,
        "owner":{
          "type":"StackOverflowUser",
          "id":223201,
          "displayName":"Tom",
          "reputation":6259
        },
        "source":[
          {
            "type":"SourceInfo",
            "node":{
              "type":"XmlTextNode",
              "contents":"I was able to reproduce this problem on Mac OS X as well."
            },
            "units":[
              {
                "type":"TextUnit",
                "id":"[4350553-cu4757538]-[1849057511]",
                "astNode":{
                  "type":"TextFragmentNode",
                  "text":"I was able to reproduce this problem on Mac OS X as well."
                },
                "codeFragments":{
                  "type":"CodeFragmentSequence",
                  "fragments":[
                    
                  ]
                },
                "metaInformation":[
                  {
                    "type":"NaturalLanguageMetaInformation",
                    "tfMap":{
                      "mac":1,
                      "reproduc":1,
                      "problem":1
                    }
                  },
                  {
                    "type":"CodeTypesMetaInformation",
                    "qualifiedTypes":[
                      
                    ],
                    "simpleTypes":[
                      
                    ],
                    "basicTypes":[
                      
                    ]
                  },
                  {
                    "type":"CodeInvocationMetaInformation",
                    "invocations":[
                      
                    ]
                  },
                  {
                    "type":"CodeVariablesMetaInformation",
                    "variables":[
                      
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "type":"StackOverflowComment",
        "id":4770231,
        "postId":4350553,
        "creationDate":"2010-12-07",
        "score":0,
        "isEdited":false,
        "owner":{
          "type":"StackOverflowUser",
          "id":55597,
          "displayName":"Scrubbie",
          "reputation":460
        },
        "source":[
          {
            "type":"SourceInfo",
            "node":{
              "type":"XmlTextNode",
              "contents":"@EJP - You might be reading it too literally. The problem isn't that you &quot;HAVE to release the lock BEFORE you can call File.delete()&quot;. You can call File.delete() before releasing the lock, however, the delete won't work. The code will execute but the method will return false and silently fail."
            },
            "units":[
              {
                "type":"TextUnit",
                "id":"[4350553-cu4770231]-[1784717491]",
                "astNode":{
                  "type":"TextFragmentNode",
                  "text":"@EJP - You might be reading it too literally. The problem isn't that you &quot;HAVE to release the lock BEFORE you can call File.delete()&quot;. You can call File.delete() before releasing the lock, however, the delete won't work. The code will execute but the method will return false and silently fail."
                },
                "codeFragments":{
                  "type":"CodeFragmentSequence",
                  "fragments":[
                    {
                      "type":"AnnotationNode",
                      "identifier":{
                        "type":"QualifiedIdentifierNode",
                        "identifiers":[
                          {
                            "type":"IdentifierNode",
                            "name":"EJP",
                            "comments":[
                              
                            ]
                          }
                        ],
                        "comments":[
                          
                        ]
                      },
                      "comments":[
                        
                      ]
                    }
                  ]
                },
                "metaInformation":[
                  {
                    "type":"NaturalLanguageMetaInformation",
                    "tfMap":{
                      "read":1,
                      "method":1,
                      "fail":1,
                      "delet":3,
                      "silent":1,
                      "problem":1,
                      "liter":1,
                      "lock":2,
                      "work":1,
                      "code":1,
                      "releas":2,
                      "isn":1,
                      "fals":1,
                      "file":2,
                      "quot":2,
                      "call":2,
                      "won":1,
                      "execut":1,
                      "ejp":1
                    }
                  },
                  {
                    "type":"CodeTypesMetaInformation",
                    "qualifiedTypes":[
                      
                    ],
                    "simpleTypes":[
                      
                    ],
                    "basicTypes":[
                      
                    ]
                  },
                  {
                    "type":"CodeInvocationMetaInformation",
                    "invocations":[
                      
                    ]
                  },
                  {
                    "type":"CodeVariablesMetaInformation",
                    "variables":[
                      
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "type":"StackOverflowComment",
        "id":4774335,
        "postId":4350553,
        "creationDate":"2010-12-07",
        "score":1,
        "isEdited":false,
        "owner":{
          "type":"StackOverflowUser",
          "id":207421,
          "displayName":"EJP",
          "reputation":133851
        },
        "source":[
          {
            "type":"SourceInfo",
            "node":{
              "type":"XmlTextNode",
              "contents":"if it doesn't work it doesn't work. I have no idea what you are trying to clarify here."
            },
            "units":[
              {
                "type":"TextUnit",
                "id":"[4350553-cu4774335]-[1110662527]",
                "astNode":{
                  "type":"TextFragmentNode",
                  "text":"if it doesn't work it doesn't work. I have no idea what you are trying to clarify here."
                },
                "codeFragments":{
                  "type":"CodeFragmentSequence",
                  "fragments":[
                    
                  ]
                },
                "metaInformation":[
                  {
                    "type":"NaturalLanguageMetaInformation",
                    "tfMap":{
                      "idea":1,
                      "work":2,
                      "clarifi":1
                    }
                  },
                  {
                    "type":"CodeTypesMetaInformation",
                    "qualifiedTypes":[
                      
                    ],
                    "simpleTypes":[
                      
                    ],
                    "basicTypes":[
                      
                    ]
                  },
                  {
                    "type":"CodeInvocationMetaInformation",
                    "invocations":[
                      
                    ]
                  },
                  {
                    "type":"CodeVariablesMetaInformation",
                    "variables":[
                      
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "tags":[
      "java",
      "file-io"
    ],
    "creationDate":"2010-12-03",
    "lastActivityDate":"2010-12-03",
    "score":6,
    "viewCount":1643,
    "owner":{
      "type":"StackOverflowUser",
      "id":55597,
      "displayName":"Scrubbie",
      "reputation":460
    },
    "source":[
      {
        "type":"SourceInfo",
        "node":{
          "type":"XmlTextNode",
          "contents":"<p>I want to read from a file and then delete it, all the while preventing other processes from accessing it. How can this be accomplished?</p>"
        },
        "units":[
          {
            "type":"TextUnit",
            "id":"[4350553]-[654248797]",
            "astNode":{
              "type":"TextFragmentNode",
              "text":"<p>I want to read from a file and then delete it, all the while preventing other processes from accessing it. How can this be accomplished?</p>"
            },
            "codeFragments":{
              "type":"CodeFragmentSequence",
              "fragments":[
                
              ]
            },
            "metaInformation":[
              {
                "type":"NaturalLanguageMetaInformation",
                "tfMap":{
                  "read":1,
                  "delet":1,
                  "process":1,
                  "prevent":1,
                  "accomplish":1,
                  "file":1,
                  "access":1
                }
              },
              {
                "type":"CodeTypesMetaInformation",
                "qualifiedTypes":[
                  
                ],
                "simpleTypes":[
                  
                ],
                "basicTypes":[
                  
                ]
              },
              {
                "type":"CodeInvocationMetaInformation",
                "invocations":[
                  
                ]
              },
              {
                "type":"CodeVariablesMetaInformation",
                "variables":[
                  
                ]
              }
            ]
          }
        ]
      },
      {
        "type":"SourceInfo",
        "node":{
          "type":"XmlTextNode",
          "contents":"<p>FileLock won't work because you have to release the lock and close the channel before you can call File.delete(). My concern is that after releasing the lock another process might lock it and start reading before the file is deleted.</p>"
        },
        "units":[
          {
            "type":"TextUnit",
            "id":"[4350553]-[-1144954826]",
            "astNode":{
              "type":"TextFragmentNode",
              "text":"<p>FileLock won't work because you have to release the lock and close the channel before you can call File.delete(). My concern is that after releasing the lock another process might lock it and start reading before the file is deleted.</p>"
            },
            "codeFragments":{
              "type":"CodeFragmentSequence",
              "fragments":[
                {
                  "type":"ReferenceTypeNode",
                  "ids":[
                    {
                      "type":"ParameterizedTypeNode",
                      "identifier":{
                        "type":"IdentifierNode",
                        "name":"FileLock",
                        "comments":[
                          
                        ]
                      },
                      "comments":[
                        
                      ]
                    }
                  ],
                  "comments":[
                    
                  ]
                }
              ]
            },
            "metaInformation":[
              {
                "type":"NaturalLanguageMetaInformation",
                "tfMap":{
                  "read":1,
                  "channel":1,
                  "delet":2,
                  "process":1,
                  "lock":4,
                  "work":1,
                  "concern":1,
                  "releas":2,
                  "file":3,
                  "start":1,
                  "close":1,
                  "call":1,
                  "won":1
                }
              },
              {
                "type":"CodeTypesMetaInformation",
                "qualifiedTypes":[
                  
                ],
                "simpleTypes":[
                  {
                    "type":"ReferenceTypeNode",
                    "ids":[
                      {
                        "type":"ParameterizedTypeNode",
                        "identifier":{
                          "type":"IdentifierNode",
                          "name":"FileLock",
                          "comments":[
                            
                          ]
                        },
                        "comments":[
                          
                        ]
                      }
                    ],
                    "comments":[
                      
                    ]
                  }
                ],
                "basicTypes":[
                  
                ]
              },
              {
                "type":"CodeInvocationMetaInformation",
                "invocations":[
                  
                ]
              },
              {
                "type":"CodeVariablesMetaInformation",
                "variables":[
                  
                ]
              }
            ]
          }
        ]
      },
      {
        "type":"SourceInfo",
        "node":{
          "type":"XmlTextNode",
          "contents":"<p>I am using Java 5 and upgrading to 6 is not an option at this time.</p>"
        },
        "units":[
          {
            "type":"TextUnit",
            "id":"[4350553]-[1877720567]",
            "astNode":{
              "type":"TextFragmentNode",
              "text":"<p>I am using Java 5 and upgrading to 6 is not an option at this time.</p>"
            },
            "codeFragments":{
              "type":"CodeFragmentSequence",
              "fragments":[
                
              ]
            },
            "metaInformation":[
              {
                "type":"NaturalLanguageMetaInformation",
                "tfMap":{
                  "upgrad":1,
                  "time":1,
                  "option":1
                }
              },
              {
                "type":"CodeTypesMetaInformation",
                "qualifiedTypes":[
                  
                ],
                "simpleTypes":[
                  
                ],
                "basicTypes":[
                  
                ]
              },
              {
                "type":"CodeInvocationMetaInformation",
                "invocations":[
                  
                ]
              },
              {
                "type":"CodeVariablesMetaInformation",
                "variables":[
                  
                ]
              }
            ]
          }
        ]
      }
    ]
  },
  "answers":[
    {
      "type":"StackOverflowAnswer",
      "id":4350579,
      "questionId":4350553,
      "comments":[
        {
          "type":"StackOverflowComment",
          "id":4770128,
          "postId":4350579,
          "creationDate":"2010-12-07",
          "score":0,
          "isEdited":false,
          "owner":{
            "type":"StackOverflowUser",
            "id":55597,
            "displayName":"Scrubbie",
            "reputation":460
          },
          "source":[
            {
              "type":"SourceInfo",
              "node":{
                "type":"XmlTextNode",
                "contents":"I think this approach will work. I've seen comments in other threads indicating that the rename is an atomic process on most JVMs if the source and destination are in the same directory (more specifically, when they are in the same file system volume)."
              },
              "units":[
                {
                  "type":"TextUnit",
                  "id":"[4350579-cu4770128]-[-1547652153]",
                  "astNode":{
                    "type":"TextFragmentNode",
                    "text":"I think this approach will work. I've seen comments in other threads indicating that the rename is an atomic process on most JVMs if the source and destination are in the same directory (more specifically, when they are in the same file system volume)."
                  },
                  "codeFragments":{
                    "type":"CodeFragmentSequence",
                    "fragments":[
                      
                    ]
                  },
                  "metaInformation":[
                    {
                      "type":"NaturalLanguageMetaInformation",
                      "tfMap":{
                        "system":1,
                        "process":1,
                        "volum":1,
                        "renam":1,
                        "jvms":1,
                        "work":1,
                        "thread":1,
                        "indic":1,
                        "comment":1,
                        "specif":1,
                        "directori":1,
                        "approach":1,
                        "file":1,
                        "atom":1,
                        "sourc":1,
                        "destin":1
                      }
                    },
                    {
                      "type":"CodeTypesMetaInformation",
                      "qualifiedTypes":[
                        
                      ],
                      "simpleTypes":[
                        
                      ],
                      "basicTypes":[
                        
                      ]
                    },
                    {
                      "type":"CodeInvocationMetaInformation",
                      "invocations":[
                        
                      ]
                    },
                    {
                      "type":"CodeVariablesMetaInformation",
                      "variables":[
                        
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "creationDate":"2010-12-03",
      "lastActivityDate":"2010-12-03",
      "score":5,
      "isAccepted":true,
      "owner":{
        "type":"StackOverflowUser",
        "id":61974,
        "displayName":"Mark Byers",
        "reputation":351531
      },
      "source":[
        {
          "type":"SourceInfo",
          "node":{
            "type":"XmlTextNode",
            "contents":"<p>I don't know if that's possible but a simple solution is to use the operating system users and permissions to make sure that only your process can read the file.</p>"
          },
          "units":[
            {
              "type":"TextUnit",
              "id":"[4350579]-[-349684177]",
              "astNode":{
                "type":"TextFragmentNode",
                "text":"<p>I don't know if that's possible but a simple solution is to use the operating system users and permissions to make sure that only your process can read the file.</p>"
              },
              "codeFragments":{
                "type":"CodeFragmentSequence",
                "fragments":[
                  
                ]
              },
              "metaInformation":[
                {
                  "type":"NaturalLanguageMetaInformation",
                  "tfMap":{
                    "read":1,
                    "permiss":1,
                    "simpl":1,
                    "system":1,
                    "process":1,
                    "oper":1,
                    "make":1,
                    "file":1,
                    "solut":1,
                    "user":1
                  }
                },
                {
                  "type":"CodeTypesMetaInformation",
                  "qualifiedTypes":[
                    
                  ],
                  "simpleTypes":[
                    
                  ],
                  "basicTypes":[
                    
                  ]
                },
                {
                  "type":"CodeInvocationMetaInformation",
                  "invocations":[
                    
                  ]
                },
                {
                  "type":"CodeVariablesMetaInformation",
                  "variables":[
                    
                  ]
                }
              ]
            }
          ]
        },
        {
          "type":"SourceInfo",
          "node":{
            "type":"XmlTextNode",
            "contents":"<p>Another approach is to rename the file to a randomly generated string then afterward lock, read, unlock then delete the renamed file. In theory another program could guess the filename and read the file just after it's unlocked but before it is deleted. But in practice you'll probably be fine.</p>"
          },
          "units":[
            {
              "type":"TextUnit",
              "id":"[4350579]-[-949557107]",
              "astNode":{
                "type":"TextFragmentNode",
                "text":"<p>Another approach is to rename the file to a randomly generated string then afterward lock, read, unlock then delete the renamed file. In theory another program could guess the filename and read the file just after it's unlocked but before it is deleted. But in practice you'll probably be fine.</p>"
              },
              "codeFragments":{
                "type":"CodeFragmentSequence",
                "fragments":[
                  
                ]
              },
              "metaInformation":[
                {
                  "type":"NaturalLanguageMetaInformation",
                  "tfMap":{
                    "read":2,
                    "program":1,
                    "random":1,
                    "delet":2,
                    "filenam":1,
                    "renam":2,
                    "afterward":1,
                    "lock":1,
                    "unlock":2,
                    "theori":1,
                    "generat":1,
                    "approach":1,
                    "file":3,
                    "fine":1,
                    "guess":1,
                    "practic":1
                  }
                },
                {
                  "type":"CodeTypesMetaInformation",
                  "qualifiedTypes":[
                    
                  ],
                  "simpleTypes":[
                    
                  ],
                  "basicTypes":[
                    
                  ]
                },
                {
                  "type":"CodeInvocationMetaInformation",
                  "invocations":[
                    
                  ]
                },
                {
                  "type":"CodeVariablesMetaInformation",
                  "variables":[
                    
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type":"StackOverflowAnswer",
      "id":4350595,
      "questionId":4350553,
      "comments":[
        {
          "type":"StackOverflowComment",
          "id":44028699,
          "postId":4350595,
          "creationDate":"2015-01-07",
          "score":0,
          "isEdited":false,
          "owner":{
            "type":"StackOverflowUser",
            "id":1137540,
            "displayName":"stenly",
            "reputation":127
          },
          "source":[
            {
              "type":"SourceInfo",
              "node":{
                "type":"XmlTextNode",
                "contents":"I have the same issue, I could rename the file and move to somewhere else but still no luck to delete it"
              },
              "units":[
                {
                  "type":"TextUnit",
                  "id":"[4350595-cu44028699]-[-792829935]",
                  "astNode":{
                    "type":"TextFragmentNode",
                    "text":"I have the same issue, I could rename the file and move to somewhere else but still no luck to delete it"
                  },
                  "codeFragments":{
                    "type":"CodeFragmentSequence",
                    "fragments":[
                      
                    ]
                  },
                  "metaInformation":[
                    {
                      "type":"NaturalLanguageMetaInformation",
                      "tfMap":{
                        "move":1,
                        "delet":1,
                        "luck":1,
                        "renam":1,
                        "issu":1,
                        "file":1
                      }
                    },
                    {
                      "type":"CodeTypesMetaInformation",
                      "qualifiedTypes":[
                        
                      ],
                      "simpleTypes":[
                        
                      ],
                      "basicTypes":[
                        
                      ]
                    },
                    {
                      "type":"CodeInvocationMetaInformation",
                      "invocations":[
                        
                      ]
                    },
                    {
                      "type":"CodeVariablesMetaInformation",
                      "variables":[
                        
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "creationDate":"2010-12-03",
      "lastActivityDate":"2010-12-03",
      "score":1,
      "isAccepted":false,
      "owner":{
        "type":"StackOverflowUser",
        "id":27657,
        "displayName":"javamonkey79",
        "reputation":7378
      },
      "source":[
        {
          "type":"SourceInfo",
          "node":{
            "type":"XmlTextNode",
            "contents":"<p>Can you move the file to an alternate location (where other potential processes can't find it) and then do your work on it there? If not, what about clearing the data in the file prior to releasing the lock?</p>"
          },
          "units":[
            {
              "type":"TextUnit",
              "id":"[4350595]-[-400168178]",
              "astNode":{
                "type":"TextFragmentNode",
                "text":"<p>Can you move the file to an alternate location (where other potential processes can't find it) and then do your work on it there? If not, what about clearing the data in the file prior to releasing the lock?</p>"
              },
              "codeFragments":{
                "type":"CodeFragmentSequence",
                "fragments":[
                  
                ]
              },
              "metaInformation":[
                {
                  "type":"NaturalLanguageMetaInformation",
                  "tfMap":{
                    "find":1,
                    "move":1,
                    "prior":1,
                    "process":1,
                    "clear":1,
                    "data":1,
                    "potenti":1,
                    "lock":1,
                    "altern":1,
                    "work":1,
                    "releas":1,
                    "file":2,
                    "locat":1
                  }
                },
                {
                  "type":"CodeTypesMetaInformation",
                  "qualifiedTypes":[
                    
                  ],
                  "simpleTypes":[
                    
                  ],
                  "basicTypes":[
                    
                  ]
                },
                {
                  "type":"CodeInvocationMetaInformation",
                  "invocations":[
                    
                  ]
                },
                {
                  "type":"CodeVariablesMetaInformation",
                  "variables":[
                    
                  ]
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}