
p: Project = input;

countsTotal: output sum of int;
countsJava: output sum of int;

counts: output top(10) of string weight int;
cs: output top(10) of string weight int;

countsTotal << 1;

foreach (i: int; match(`^java$`, lowercase(p.programming_languages[i]))) {
	countsJava << 1;
}

revs: int = 0;
pstart: time = now();
pend: time = 0;

visit(p, visitor {
	before node: CodeRepository -> {
	    revs = revs + len(node.revisions);	    	    
	}
	before node: Revision -> {
		pstart = min(pstart, node.commit_date);
		pend = max(pend, node.commit_date);
	}
});

counts << p.project_url weight revs;
